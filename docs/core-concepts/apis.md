---
sidebar_position: 2
---

# APIs

APIs are used to expose your data and interact with the outside world (eg. your frontend, clients, ...). Gaudi lets you create REST APIs based on your data models and their relationships. They are designed to offer a predictable behavior with very little code, which can be customized and extended when needed.

Using your API definition Gaudi can also automatically generate OpenAPI specification and client integration libraries that help you try, test and integrate your API from day one.

## Defining endpoints

The concept of an API revolves around, `api`, `entrypoint` and `endpoint` blocks.

Entrypoint is a group of endpoints which operate on the same resource, a model or a model relationship. Several `entrypoint`s can be grouped into a common `api` block.

Endpoints represent specific REST endpoints. Gaudi supports five built-in and one custom endpoint:

- `create` - uses HTTP `POST`, creates a new record
- `list` - uses HTTP `GET`, returns a list of records
- `get` - uses HTTP `GET`, returns a single record
- `update` - uses HTTP `PATCH`, updates a single record
- `delete` - uses HTTP `DELETE`, deletes a single record
- `custom` - completely customizable endpoint

Here is a short example of an API specification:

```javascript
api {
  // operations on "Topic" model
  entrypoint Topic {
    create endpoint {} // POST /api/topic/
    get endpoint {}    // GET /api/topic/{id}/
    custom endpoint {  // POST /api/topic/search/
      POST many "/search"
      ...
    }
    custom endpoint {  // POST /api/topic/{id}/disable/
      POST one "/disable"
      ...
    }
  }
}
```

## Identifying specific records

Some endpoints operate on a whole collection of records and the others operate on a single record.
This is reflected in endpoint's context, return type but also in the way a URL is constructed for each endpoint type.

### Collection endpoints

Collection endpoints types:

- `create` endpoint
- `list` endpoint
- `custom` endpoint with `many` cardinality

They require only data model name

```
/api/topic
```

### Single endpoints

Single endpoint types:

- `get` endpoint
- `update` endpoint
- `delete` endpoint
- `custom` endpoint with `one` cardinality

These endpoints require both data model name and record identifier

```
/api/topic/{identifier}
```

In order to look up a specific record, by default Gaudi expects a record identifier in the URL path. By default, Gaudi uses autogenerated `id` field, but this can be customized using `identify` property.

```
entrypoint Topic {
  identify { through name }
}
```

## Response schema

Each `entrypoint` is based on a single data model called a _"target"_ and each `endpoint` returns some part (fields) of this target model.

To define which part of the target model is returned you can use `response` block. `response` can be specified per `entrypoint` or per `endpoint`.

```javascript
api {
  entrypoint Topic {
    response { id, title, author { id, username, profile { imageUrl } } }
  }
}
```

By default, all the fields on the target model will be included. This is also true for relationship fields without its own block.

```
// includes ALL fields of "author" relation
response { id, title, author }

// includes only "name" of "author" relation
response { id, title, author { name } }
```

## Request body schema

`create` and `update` endpoints may need to accept certain input values from the client, tipically via HTTP request body. Gaudi analyses the endpoint specification and computes the desired request schema.

More about this in [Actions](./actions.md)
