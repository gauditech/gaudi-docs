---
sidebar_position: 2
---

# How it works

Gaudi is a declarative programming language and due to it's declarative syntax Gaudi allows developers to focus on **what** needs to be done, instead of **how**. This approach allows Gaudi to understand the intention behind your code. Because of that, it can produce optimal code for you and automate a lot of the work around it. Things like logging, error handling, documentation, full stack type safety, optimized queries, ... all are generated by Gaudi according to your descriptions.

## Architecture

Gaudi consists of three main parts: **compiler**, **runtime**, **CLI**.

#### Compiler

Gaudi compiler [handles](./application#building) the "declarative programming language" part. It's job is to read all your Gaudi source files, validate them, report any errors and compile a so called application _"definition"_. This "definition" is a description, a set of instructions, for running your application.

#### Runtime

Gaudi runtime [handles](application#running) the "run application" part. Runtime takes the "definition" created by the compiler, configures application endpoints, actions, validations, database connection, custom hooks, integrations, logging, ..., everything you've described in your Gaudi source files, and runs it.

#### CLI

CLI is an interactive command line tool that is the entrypoint for all Gaudi parts. Use it to compile your app, to run it, to sync and populate your development database, to migrate your production database, ...

// TODO: Gaudi architecture image

## First application

Let's walk through some of Gaudi's basic concepts by describing a simple book reviews application. This is not a full tutorial with all the details, just a conceptual walkthrough. You can find detailed tutorials in our [tutorials](../tutorials) section.

### Create model

As any other application, let's start with our models.

Gaudi model language is designed to be very intuitive and database agnostic. The idea is to worry about describing your models and relationships between them instead of database details.

```js title="bookstore.gaudi"
model Author {
  field name { type string }

  relation books { from Book, through author }
}

model Book {
  reference author { to Author }

  field title { type string }
  field summary { type string }
}
```

We've created two related models, `Author` and `Book`. These models correspond to database tables, fields correspond to table columns and relations correspond to foreign keys. Standard database concepts only written in a nicer way.

### Expose API

Now that we have our models, we need to expose those data to our clients and users, iow. we need to create an API.

Gaudi uses a concept of `entrypoint`s which represent a group of endpoints and operations on a single resource, e.g. a model or a relation.

```js title="bookstore.gaudi"
api {
  // operations on `Author` model
  entrypoint Author {
    // define CRUD endpoints
    // GET /api/author/<id>
    get endpoint {}
    // GET /api/author
    list endpoint {}
    // POST /api/author
    create endpoint {}
    // PATCH /api/author/<id>
    update endpoint {}
    // DELETE /api/author/<id>
    delete endpoint {}
  }

  // ... entrypoint on `Book` model
}
```

We've created 5 standard REST CRUD endpoints on each of our models in only a few lines of code (if we ignore the comments :)). And that's it, we have defined our entire API.

### Compile

Now that we've described our simple application, we're ready to run it. Since Gaudi is a language after all, we need a compiler to convert it into something _"runnable"_. We run Gaudi compiler using Gaudi CLI tool

```sh
npx gaudi build
```

Read more on compiling Gaudi apps [here](../core-concepts/application).

### Run

Now we're ready to run our application. Again, we need a tool from Gaudi's toolkit called `runtime` and we can use it via Gaudi CLI

```sh
npx gaudi start
```

Voila! We should have our database created and our endpoints ready to handle requests.

But, our database is empty. Wouldn't it be great if we could populate our database automatically, without having to do it manually each time we recreate our database?

### Populate

Gaudi toolkit has another tool just for that purpose and it's called `populator`. We use similar syntax we've used to describe our API to populate it with some data.

```js title="bookstore.gaudi"
// populator named "Dev"
populator Dev {
  // populate Author model
  populate Author as author {
    // repeat 15 times
    repeat as aIter 15

    set name "Author #" + stringify(aIter.current)

    // populate Book model
    // using `book` relation to created related records
    populate books {
    // repeat 2 times - for EACH author
      repeat as bIter 2

      // set fields
      set title "Book title #" + stringify(bIter.current)
      set summary "Summary of book #" + stringify(bIter.current) + " by " + author.name
    }
  }
}
```

Now we can run this populator each time we change our database and have our database populated.

Ofc, we can have as many populators as we like. We can have e.g. one simple for development, one strict for testing, one randomized and real world for presentations, ... you get the point. Don't let your database be empty ever again!

### Custom code

Declarative approach is great when it comes to using well known concepts and best practices for building most of our application. But every once in a while we simply need to resort to some specific imperative code (e.g. cryptography, payment, external tools and services, our own custom behavior, ...). This is where Gaudi hooks jump in. They are the _"escape hatches"_ which allow you to resort to any custom code or library you need and make sure it all runs happily inside Gaudi.

Gaudi also supports expressions wich allow you custom data manipulations (e.g. string manipulation, number calculations, ...) while still staying in Gaudi's controlled environment.

Oh, did we mention you can use hooks and expressions in database queries and as model properties! ðŸ˜Ž

## Next steps

What's next? We recommend that you read [Core concepts](../core-concepts/) first to get a better understanding of Gaudi basics. Then head for our [tutorials](../tutorials/) sections and pick some hands-on examples you can build on your own. For any further questions and deep dives please consult our [advanced topics](../advanced-topics) and [language reference](../reference/) section.

We're sure you'll quickly have a ton of other questions and suggestions that we haven't thought of or haven't got around to put them in writing. That's where you come in! ;) Ask us, open an issue or event better, open a PR. :)

Happy coding!
